<!-- Content -->
<main class="p-4">
  <!-- Action Bar -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
      <div>
          <h1 class="text-2xl font-bold text-gray-800">Gestión de Cursos</h1>
          <p class="text-gray-500">Administra todos los cursos de la plataforma</p>
      </div>
      <div class="flex flex-col sm:flex-row gap-3">
          <div class="relative">
              <select class="pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-300 appearance-none bg-white">
                  <option>Todos los cursos</option>
                  <option>Publicados</option>
                  <option>Borradores</option>
                  <option>Archivados</option>
              </select>
              <i class="fas fa-filter absolute left-3 top-2.5 text-gray-400"></i>
          </div>
          <!-- Boton de nuevo curso -->
          <!-- <p-button (click)="showDialog()" icon="pi pi-plus-circle" label="Nuevo Curso" /> -->
          <app-modal-curso></app-modal-curso>

      </div>
  </div>

 
  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
      <div class="bg-white p-6 rounded-xl shadow-sm hover-scale">
          <div class="flex justify-between items-start">
              <div>
                  <p class="text-gray-500">Total Cursos</p>
                  <h3 class="text-2xl font-bold mt-2">124</h3>
                  <p class="text-sm text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i> 12% este mes</p>
              </div>
              <div class="p-3 rounded-lg bg-orange-100 text-orange-600">
                  <i class="fas fa-book text-xl"></i>
              </div>
          </div>
      </div>

      <div class="bg-white p-6 rounded-xl shadow-sm hover-scale">
          <div class="flex justify-between items-start">
              <div>
                  <p class="text-gray-500">Cursos Activos</p>
                  <h3 class="text-2xl font-bold mt-2">98</h3>
                  <p class="text-sm text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i> 5% este mes</p>
              </div>
              <div class="p-3 rounded-lg bg-green-100 text-green-600">
                  <i class="fas fa-check-circle text-xl"></i>
              </div>
          </div>
      </div>

      <div class="bg-white p-6 rounded-xl shadow-sm hover-scale">
          <div class="flex justify-between items-start">
              <div>
                  <p class="text-gray-500">Inscripciones</p>
                  <h3 class="text-2xl font-bold mt-2">3,842</h3>
                  <p class="text-sm text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i> 18% este mes</p>
              </div>
              <div class="p-3 rounded-lg bg-blue-100 text-blue-600">
                  <i class="fas fa-user-graduate text-xl"></i>
              </div>
          </div>
      </div>

      <div class="bg-white p-6 rounded-xl shadow-sm hover-scale">
          <div class="flex justify-between items-start">
              <div>
                  <p class="text-gray-500">Valoración Media</p>
                  <h3 class="text-2xl font-bold mt-2">4.7/5</h3>
                  <p class="text-sm text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i> 0.2 este mes</p>
              </div>
              <div class="p-3 rounded-lg bg-yellow-100 text-yellow-600">
                  <i class="fas fa-star text-xl"></i>
              </div>
          </div>
      </div>
  </div>

  <app-tabla-curso></app-tabla-curso>

  <!-- Recent Courses Grid -->
  <div class="mb-6">
      <div class="flex justify-between items-center mb-4">
          <h3 class="font-semibold">Cursos Recientes</h3>
          <!-- <button class="text-orange-600 text-sm font-medium">Ver todos</button> -->
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          <!-- Course Card 1 -->
           @for (curso of cursos; track curso.id) {
            <div class="bg-white rounded-xl shadow-sm overflow-hidden hover-scale course-card">
                   <div class="relative">
                       <img [src]="curso.imagen" [alt]="curso.nombre" class="w-full h-40 object-cover">
                       <div class="absolute top-3 right-3 bg-white rounded-full px-2 py-1 text-xs font-medium text-orange-600">
                           Nuevo
                       </div>
                       <div class="course-actions absolute inset-0 bg-opacity-50 flex items-center justify-center space-x-2">
                           <button class="p-2 bg-white rounded-full text-orange-600 hover:bg-orange-100">
                               <i class="fas fa-edit"></i>
                           </button>
                           <button class="p-2 bg-white rounded-full text-orange-600 hover:bg-orange-100">
                               <i class="fas fa-eye"></i>
                           </button>
                           <button class="p-2 bg-white rounded-full text-red-600 hover:bg-red-100">
                               <i class="fas fa-trash"></i>
                           </button>
                       </div>
                   </div>
                   <div class="p-4">
                       <div class="flex justify-between items-start mb-2">
                           <span class="px-2 py-1 text-xs rounded-full bg-orange-100 text-orange-600">{{ curso.categoria.nombre}}</span>
                           <div class="flex items-center">
                               <i class="fas fa-star text-orange-400 text-xs"></i>
                               <span class="text-xs ml-1">4.8</span>
                           </div>
                       </div>
                       <h4 class="font-semibold mb-1">{{ curso.nombre}}</h4>
                       <p class="text-sm text-gray-500 mb-2">{{ curso.descripcion}}</p>
                       <div class="flex justify-between items-center">
                           <p class="font-bold text-orange-600">S/.{{ curso.precio}}</p>
                           <div class="flex items-center text-sm text-gray-500">
                               <i class="fas fa-users mr-1"></i>
                               <span>45</span>
                           </div>
                       </div>
                   </div>
            </div>
            
           }

          
      </div>
  </div>

  <!-- Categories Section -->
  <app-modal-categoria></app-modal-categoria>

  <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
      <div class="flex justify-between items-center mb-6">
        <div>
            <h3 class="font-semibold">Categorías de Cursos</h3>
        </div>
        <div>
            <p-button (click)="modalCategoria()" label="Añadir categorías" icon="pi pi-plus-circle"  />
        </div>  
          <!-- <button class="text-orange-600 text-sm font-medium">Administrar categorías</button> class="text-orange-600 text-sm font-medium" -->
          <!-- boton a qui -->

      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">

        @for(categoria of categorias; track categoria.id){
         <div class="p-4 rounded-xl flex flex-col items-center transition cursor-pointer"
                [ngClass]="['bg-' + categoria.color + '-50', 'hover:bg-' + categoria.color + '-100']" >

             <div class="w-12 h-12 rounded-full flex items-center justify-center mb-3"
                [ngClass]="['bg-' + categoria.color + '-100 text-' + categoria.color + '-600']" >
                
                 <!-- <i class="fas text-xl" [ngClass]="categoria.icono"></i> -->
                 <span [ngClass]="categoria.icono" class="text-xl"></span>
             </div>
             <h4 class="font-medium">{{ categoria.nombre}}</h4>
             <p class="text-sm text-gray-500 text-center mt-1">{{ categoria._count.cursos}} Cursos</p>
         </div>
        }
        
      </div>
  </div>

  <!-- <p-button label="Nueva categoría" icon="pi pi-plus" (click)="cancelar()" styleClass="mb-3" /> -->


  <!-- <form [formGroup]="form()">
    <div class="p-fluid">
      <div class="p-field">
        <label for="nombre">Nombre</label>
        <input pInputText id="nombre" formControlName="nombre" />
      </div>

      <div class="p-field">
        <label for="descripcion">Descripción</label>
        <input pInputText id="descripcion" formControlName="descripcion" />
      </div>

      <div class="p-field">
        <label for="color">Color</label>
        <p-colorPicker id="color" formControlName="color" format="hex" />
      </div>

      <div class="p-field">
        <label for="icono">Icono</label>
        <input pInputText id="icono" formControlName="icono" placeholder="ej: star, heart, tag" />
      </div>
    </div>
  </form> -->




  
</main>





  
    <p-dialog [(visible)]="visible" [modal]="true" >
        <form class="grid md:grid-cols-2 gap-2 w-[520px]" >

          <div class="mb-5 col-span-2">
            <label for="email" class="block mb-2 text-sm font-medium text-gray-900 ">Nombre de la categoria</label>
            <input type="email" id="email" class="shadow-xs bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 "  />
          </div>
          
          <div class="mb-5 col-span-2">
            <label for="descripcion" class="block mb-2 text-sm font-medium text-gray-900 ">Descripcion de general</label>
            <textarea id="descripcion" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 " ></textarea>
          </div>


           <div class="mb-5">
              <label class="block mb-2 text-sm font-medium text-gray-900">Color de categoría </label>

              <div class="relative" id="colorPicker">

                <div (click)="togglePalette()"
                     class="flex items-center gap-2 p-2.5 bg-gray-50 border border-gray-300 rounded-lg cursor-pointer">

                        <div class="size-6 rounded-md border border-gray-200"
                             [ngStyle]="{ 'background-color': selectedColor.hex }"></div>

                        <span class="text-sm text-gray-900 flex-1">{{ selectedColor.hex }}</span>

                        <input 
                          type="color" 
                          [value]="selectedColor.hex" 
                          class="w-0 h-0 opacity-0 absolute" 
                          id="colorInput"
                          (change)="onCustomColorChange($event)"
                        />

                        <label 
                          for="colorInput" 
                          class="text-xs text-blue-600 cursor-pointer hover:text-blue-800">
                          Custom
                        </label>
                </div>

                <!-- Paleta de colores -->
                <div *ngIf="showPalette"
                     class="absolute z-10 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-3 w-full max-w-   [280px]        grid grid-cols-4 gap-2 transition-all animate-fade-in">
                  <div *ngFor="let color of colores"
                       (click)="selectColor(color)"
                       [ngStyle]="{ 'background-color': color.hex }"
                       class="w-8 h-8 rounded-md border cursor-pointer hover:scale-105 transition"
                       [class.ring-2]="color.hex === selectedColor.hex"
                       [class.ring-blue-500]="color.hex === selectedColor.hex">
                  </div>
                </div>
             </div>
        </div>


            <div class="mb-4">
              <label class="block mb-2 text-sm font-medium text-gray-900">
                Icono de categoría
              </label>
              <div class="relative" id="iconSelector">
                <!-- Vista seleccionada -->
                <div (click)="toggleIconPalette()"
                     class="flex items-center gap-2 p-2.5 bg-gray-50 border border-gray-300 rounded-lg cursor-pointer">
                  <i [ngClass]="selectedIcon.class" class="w-5 h-5 text-gray-700"></i>
                  <span class="text-sm text-gray-900 flex-1">{{ selectedIcon.name }}</span>
                </div>
            
                <!-- Paleta de iconos -->
                <div *ngIf="showPalette"
                     class="absolute z-10 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-3 w-full max-w-[280px]            transition-all animate-fade-in">

                  <!-- Input búsqueda -->
                  <div class="mb-2 flex items-center border border-gray-300 rounded-md px-2">
                    <i class="fa-solid fa-search w-4 h-4 text-gray-400"></i>
                    <input
                      type="text"
                      placeholder="Buscar iconos..."
                      (input)="filterIcons($event)"
                      class="w-full p-2 text-sm focus:outline-none"
                    />
                  </div>
              
                  <!-- Grid de iconos -->
                  <div class="grid grid-cols-5 gap-2 max-h-[200px] overflow-y-auto">
                    <div *ngFor="let icon of filteredIcons"
                         (click)="selectIcon(icon)"
                         class="p-2 rounded-lg border hover:bg-gray-100 cursor-pointer flex items-center justify-center"
                         [class.bg-gray-100]="icon.class === selectedIcon.class">
                      <i [ngClass]="icon.class" class="text-lg"></i>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex justify-end mb-5 col-span-2 ">
                <button type="submit" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center hover:cursor-pointer">Guardar</button>
            </div>
        </form>
    </p-dialog>
